# Инструкция по использованию калькулятора валют

## Общее описание

Калькулятор валют GOBEX - это инструмент для расчета конвертации валют с учетом актуальных курсов, комиссий и дополнительных сборов. Калькулятор доступен всем авторизованным пользователям системы.

## Функциональность

### Основные возможности

- Конвертация между различными валютами
- Расчет комиссий и сборов
- Отображение актуальных курсов
- История конвертаций
- Сохранение избранных валютных пар

### Доступ к калькулятору

Калькулятор доступен по адресу `/calculator` для всех авторизованных пользователей. Различные роли пользователей имеют разные возможности:

- **Администратор**: полный доступ ко всем функциям
- **Брокер**: доступ к установке курсов и комиссий
- **Партнер**: просмотр истории конвертаций своих компаний
- **Пользователь**: базовый доступ к конвертации

## Использование калькулятора

### Шаг 1: Выбор валют

1. Выберите исходную валюту из выпадающего списка
2. Выберите целевую валюту
3. Введите сумму для конвертации

### Шаг 2: Дополнительные параметры

- Выберите тип конвертации (спот/форвард)
- Укажите дату валютирования (для форвардных сделок)
- При необходимости выберите компанию (для партнеров)

### Шаг 3: Расчет

1. Нажмите кнопку "Рассчитать"
2. Система отобразит:
   - Курс конвертации
   - Сумму к получению
   - Комиссию
   - Итоговую сумму

### Шаг 4: Сохранение результата

- Сохраните расчет в историю
- Экспортируйте результат в PDF (опционально)
- Отправьте расчет на email (опционально)

## Формулы расчета

### Базовая конвертация
```
Сумма к получению = Исходная сумма * Курс конвертации
```

### Расчет с комиссией
```
Итоговая сумма = Сумма к получению - Комиссия
Где:
Комиссия = Сумма к получению * Процент комиссии
```

### Расчет НДС
```
НДС = Комиссия * Ставка НДС
```

## API калькулятора

### Endpoints

```typescript
// Получение курсов
GET /api/calculator/rates
Response: {
  rates: {
    [key: string]: {
      buy: number;
      sell: number;
      updated: Date;
    }
  }
}

// Расчет конвертации
POST /api/calculator/calculate
Request: {
  fromCurrency: string;
  toCurrency: string;
  amount: number;
  type: 'spot' | 'forward';
  date?: Date;
  companyId?: string;
}
Response: {
  rate: number;
  amount: number;
  commission: number;
  vat: number;
  total: number;
}

// История конвертаций
GET /api/calculator/history
Query: {
  page?: number;
  limit?: number;
  startDate?: Date;
  endDate?: Date;
}
```

## Поддерживаемые валюты

### Основные валюты
- USD (Доллар США)
- EUR (Евро)
- RUB (Российский рубль)
- KZT (Казахстанский тенге)

### Дополнительные валюты
- GBP (Британский фунт)
- CNY (Китайский юань)
- JPY (Японская иена)
- И другие по запросу

## Ограничения

1. **Минимальная сумма**
   - USD/EUR: от 100
   - Другие валюты: эквивалент 100 USD

2. **Максимальная сумма**
   - Зависит от роли пользователя и настроек компании
   - Может быть изменена администратором

3. **Временные ограничения**
   - Спот: расчет по текущему курсу
   - Форвард: до 1 года вперед

## Часто задаваемые вопросы

### 1. Как обновляются курсы?
Курсы обновляются автоматически каждые 5 минут. Брокеры могут обновлять курсы вручную.

### 2. Как рассчитывается комиссия?
Комиссия зависит от:
- Объема операции
- Валютной пары
- Типа клиента
- Дополнительных условий

### 3. Можно ли отменить расчет?
Сохраненные расчеты можно отменить в течение 15 минут после создания.

## Поддержка

При возникновении вопросов или проблем:
1. Обратитесь к администратору системы
2. Напишите в техподдержку
3. Проверьте документацию API

## Обновления и изменения

Все изменения в работе калькулятора публикуются в разделе "Новости" и рассылаются пользователям по email.
